"use strict";var Poker=function(){var e=this;this.popup=document.querySelector(".popup"),this.popupClose=document.querySelector(".popup__close"),this.cardList=document.querySelector(".card__list"),this.loadIndex=1,this.combName=["Роял Стрит Флэш","Стрит Флэш","Каре","Фулл хаус","Флеш","Стрит","Тройка","Две пары","Пара","Старшая карта"],this.combDesc=["5 старших карт одной масти","любые пять карт одной масти по порядку","четыре карты одного достоинства","одна тройка и одна пара","пять карт одной масти","пять карт по порядку любых мастей","три карты одного достоинства","две пары карт одного достоинства","две карты одного достоинства","ни одна из вышеописанных комбинаций"],this.setCardSize=function(){var t=e.cardList.children,n=document.querySelector(".container").clientHeight,o=window.innerWidth<window.innerHeight?5:2;[].forEach.call(t,function(e){e.style.cssText="height:"+n/o+"px"})},this.showPopup=function(t){var n=document.querySelector(".popup__image"),o=document.querySelector(".popup__title"),r=document.querySelector(".popup__desc");e.popup.classList.add("popup--open"),n.style.backgroundImage="url(img/hand-"+t+".png)",o.innerText=""+e.combName[t-1],r.innerText=""+e.combDesc[t-1]},this.hidePopup=function(){e.popup.classList.remove("popup--open")},this.showPercent=function(t,n){var o=Math.round(t/n*100),r=document.querySelector(".preload"),i=document.querySelector(".preload__percent"),a=document.querySelector(".preload__line");i.setAttribute("data-percent",o),a.style.cssText="-webkit-transform: translate3d(-"+(100-o)+"%,0,0);\n                                     transform: translate3d(-"+(100-o)+"%,0,0)",t==n&&(document.body.removeChild(r),e.setCardSize())},this.setTransformOrigin=function(t,n){e.popup.style.cssText="-webkit-transform-origin: "+t+"% "+n+"% 0;\n                                    transform-origin: "+t+"% "+n+"% 0;"},this.loadImage=function(){return new Promise(function(t,n){var o=new Image;o.src="img/hand-"+e.loadIndex+".png",o.onload=function(){e.showPercent(e.loadIndex,e.combName.length),t(o.src),e.loadIndex!==e.combName.length&&(e.loadIndex++,e.loadImage())},o.onerror=function(){return n()}})},this.preloadImages=function(){for(var t=[],n=e.combName.length,o=0,r=1;r<n+1;r++)t[r]=new Image,t[r].src="img/hand-"+r+".png",t[r].onload=function(){o++,e.showPercent(o,n),o==n&&e.setCardSize()}},this.popupClose.addEventListener("click",e.hidePopup),this.cardList.addEventListener("click",function(t){var n=t.pageX/window.innerWidth*100,o=t.pageY/window.innerHeight*100,r=t.target;"card__image"!=t.target.className&&"card__title"!=t.target.className||(r=t.target.parentNode),e.setTransformOrigin(n,o),e.showPopup(r.getAttribute("data-index"))}),window.addEventListener("resize",e.setCardSize)};window.addEventListener("DOMContentLoaded",function(){var e=new Poker;window.Promise?e.loadImage():e.preloadImages()});